<header class="site-header">
  <div class="layout-container header__row">

    <div class="header-left">
      <a href="{{ path('home') }}" class="brand" aria-label="EcoRide - Accueil">
        <img
          src="{{ asset('./img/Logo_horizontal_transparent_soft.png') }}"
          alt="Logo EcoRide"
          class="brand__logo"
        >
      </a>

      <nav class="site-nav" aria-label="Navigation principale">
        <a href="{{ path('how_it_works') }}" class="site-nav__link">Comment ça marche ?</a>
        <a href="{{ path('covoiturages') }}" class="site-nav__link">Covoiturages</a>
        <a href="{{ path('credit_buy') }}" class="site-nav__link">Acheter des crédits</a>
        <a href="{{ path('contact') }}" class="site-nav__link">Contact</a>
      </nav>
    </div>

    <div class="header-right">
      {% if not app.user %}
        <a href="{{ path('login') }}" class="action-publish">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/>
            <path d="M12 8v8M8 12h8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Publier un trajet
        </a>
      {% elseif app.user.profilType in ['driver', 'both'] %}
        <a href="{{ path('covoiturage_publish') }}" class="action-publish">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="12" r="9" fill="none" stroke="currentColor" stroke-width="2"/>
            <path d="M12 8v8M8 12h8" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
          </svg>
          Publier un trajet
        </a>
      {% endif %}

      <details class="account-menu">
        <summary class="account-summary" aria-haspopup="menu">
          <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
            <circle cx="12" cy="8" r="4" fill="none" stroke="currentColor" stroke-width="2"/>
            <path d="M4 20c0-4 4-6 8-6s8 2 8 6" fill="none" stroke="currentColor" stroke-width="2"/>
          </svg>

          {% if app.user %}
            {{ app.user.pseudo ?? app.user.email ?? 'Mon compte' }}
          {% else %}
            Mon compte
          {% endif %}

          <svg class="caret" viewBox="0 0 24 24" aria-hidden="true">
            <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </summary>

        <div class="account-dropdown" role="menu">
          {% if not app.user %}
            <a href="{{ path('login') }}" class="menu-item" role="menuitem">
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M10 17l-5-5 5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M4.5 12H17" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M17 4h3v16h-3" fill="none" stroke="currentColor" stroke-width="2"/>
              </svg>
              Connexion
            </a>

            <a href="{{ path('register') }}" class="menu-item" role="menuitem">
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Z" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M4 20c0-3.5 3.6-5.5 8-5.5S20 16.5 20 20" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M19 7v4M17 9h4" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              Créer un compte
            </a>
          {% else %}
            <a href="{{ path('profile') }}" class="menu-item" role="menuitem">
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Z" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M4 20c0-3.5 3.6-5.5 8-5.5S20 16.5 20 20" fill="none" stroke="currentColor" stroke-width="2"/>
              </svg>
              Mon profil
            </a>

            <a href="{{ path('profile_rides') }}" class="menu-item" role="menuitem">
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <rect x="3" y="11" width="18" height="7" rx="2" ry="2" fill="none" stroke="currentColor" stroke-width="2"/>
                <circle cx="7" cy="16" r="1.5" fill="none" stroke="currentColor" stroke-width="2"/>
                <circle cx="17" cy="16" r="1.5" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M6 11V9a3 3 0 0 1 3-3h6a3 3 0 0 1 3 3v2" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              Voir mes trajets
            </a>

            <a href="{{ path('profile_feedback') }}" class="menu-item" role="menuitem">
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M4 4h16v16H4Z" fill="none" stroke="currentColor" stroke-width="2"/>
                <path d="M8 10h8M8 14h5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
              </svg>
              Mes avis trajets
            </a>

            {% if is_granted('ROLE_ADMIN') %}
              <a href="{{ path('admin_dashboard') }}" class="menu-item" role="menuitem">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M4 4h16v16H4Z" fill="none" stroke="currentColor" stroke-width="2"/>
                  <path d="M4 9h16M9 4v16" fill="none" stroke="currentColor" stroke-width="2"/>
                  <path d="M8 13h4v4H8Z" fill="none" stroke="currentColor" stroke-width="2"/>
                </svg>
                Espace admin
              </a>
            {% endif %}

            {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_EMPLOYE') %}
              <a href="{{ path('admin_avis_index') }}" class="menu-item" role="menuitem">
                <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M4 4h16v16H4Z" fill="none" stroke="currentColor" stroke-width="2"/>
                  <path d="M4 9h16M9 4v16" fill="none" stroke="currentColor" stroke-width="2"/>
                </svg>
                Espace employé
              </a>
            {% endif %}

            <a href="{{ path('logout') }}" class="menu-item" role="menuitem">
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M14 17l5-5-5-5" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                <path d="M19.5 12H7" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
                <path d="M7 4h-3v16h3" fill="none" stroke="currentColor" stroke-width="2"/>
              </svg>
              Déconnexion
            </a>
          {% endif %}
        </div>
      </details>
    </div>
  </div>
</header>
