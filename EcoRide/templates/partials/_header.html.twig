<header class="site-header">
  <nav class="navbar navbar-expand-lg bg-white border-bottom py-2">
    <div class="container-fluid px-3 px-lg-4">

      <a class="navbar-brand
                mx-auto mx-lg-0
                order-0 order-lg-0"
         href="{{ path('home') }}"
         aria-label="EcoRide - Accueil">
        <img
          src="{{ asset('./img/Logo_horizontal_transparent_soft.png') }}"
          alt="Logo EcoRide"
          class="brand__logo"
          style="height:52px; height:60px;"
        >
      </a>

      <div class="d-flex align-items-center gap-2 order-1 order-lg-2">

        <div class="dropdown">
          <button class="btn btn-link text-decoration-none fw-semibold d-flex align-items-center gap-1"
                  type="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false">
            <i class="bi bi-person-circle fs-5"></i>

            <span class="d-none d-lg-inline">
              {% if app.user %}
                {{ app.user.pseudo ?? app.user.email ?? 'Mon compte' }}
              {% else %}
                Mon compte
              {% endif %}
            </span>

            <i class="bi bi-caret-down-fill small"></i>
          </button>

          <ul class="dropdown-menu dropdown-menu-end shadow-sm">
            {% if not app.user %}
              <li><a class="dropdown-item" href="{{ path('login') }}">Connexion</a></li>
              <li><a class="dropdown-item" href="{{ path('register') }}">Créer un compte</a></li>
            {% else %}
              <li><a class="dropdown-item" href="{{ path('profile') }}">Mon profil</a></li>
              <li><a class="dropdown-item" href="{{ path('profile_rides') }}">Voir mes trajets</a></li>
              <li><a class="dropdown-item" href="{{ path('profile_feedback') }}">Mes avis trajets</a></li>
              <li><hr class="dropdown-divider"></li>

              {% if is_granted('ROLE_ADMIN') %}
                <li><a class="dropdown-item" href="{{ path('admin_dashboard') }}">Espace admin</a></li>
              {% endif %}
              {% if is_granted('ROLE_ADMIN') or is_granted('ROLE_EMPLOYE') %}
                <li><a class="dropdown-item" href="{{ path('admin_avis_index') }}">Espace employé</a></li>
              {% endif %}

              <li><hr class="dropdown-divider"></li>
              <li><a class="dropdown-item" href="{{ path('logout') }}">Déconnexion</a></li>
            {% endif %}
          </ul>
        </div>

        <button class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#mainNav"
                aria-controls="mainNav"
                aria-expanded="false"
                aria-label="Ouvrir le menu">
          <span class="navbar-toggler-icon"></span>
        </button>
      </div>

      <div class="collapse navbar-collapse order-2 order-lg-1" id="mainNav">

        <ul class="navbar-nav mx-auto text-center gap-lg-4 mt-3 mt-lg-0">
          <li class="nav-item">
            <a class="nav-link" href="{{ path('how_it_works') }}">Comment ça marche ?</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ path('covoiturages') }}">Covoiturages</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ path('credit_buy') }}">Acheter des crédits</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="{{ path('contact') }}">Contact</a>
          </li>
        </ul>

        <div class="text-center text-lg-end mt-3 mt-lg-0">
          {% if not app.user %}
            <a href="{{ path('login') }}"
               class="btn btn-outline-success btn-sm px-3">
              Publier un trajet
            </a>
          {% elseif app.user.profilType in ['driver','both'] %}
            <a href="{{ path('covoiturage_publish') }}"
               class="btn btn-outline-success btn-sm px-3">
              Publier un trajet
            </a>
          {% endif %}
        </div>

      </div>
    </div>
  </nav>
</header>
